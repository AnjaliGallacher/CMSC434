<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, user-scalable=no"
		/>
		<title>Log Meal - iPad View</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<link rel="stylesheet" href="style.css" />
		<style>
			/* Page-specific overrides if necessary */
		</style>
	</head>
	<body>
		<div class="ipad-container">
			<!-- Header -->
			<div class="header">
				<!-- Standard Header -->
				<!-- Centered Title Structure -->
				<div class="header-action"></div>
				<!-- Spacer -->
				<span class="header-title">Log Meal</span>
				<div class="header-action">
					<button class="action-button" onclick="saveMeal()">
						Save
					</button>
				</div>
			</div>

			<!-- Main Scrollable Content Area -->
			<div class="main-content">
				<!-- Standard Padding -->
				<!-- Date, Time, Meal Type Group -->
				<div class="input-group">
					<div class="input-row">
						<div>
							<label for="meal-date" class="form-label">
								<span class="form-label-icon">📅</span>Date
							</label>
							<input type="date" id="meal-date" name="meal-date"
							class="form-input" value="<!--#echo var="DATE_LOCAL" -->"
							/>
						</div>
						<div>
							<label for="meal-time" class="form-label">
								<span class="form-label-icon">⏰</span>Time
							</label>
							<input type="time" id="meal-time" name="meal-time"
							class="form-input" value="<!--#echo var="TIME_LOCAL" -->"
							/>
						</div>
					</div>
					<div>
						<label for="meal-type" class="form-label">
							<span class="form-label-icon">🍳</span>Meal Type
						</label>
						<select
							id="meal-type"
							name="meal-type"
							class="form-select"
						>
							<option value="breakfast">Breakfast</option>
							<option value="lunch">Lunch</option>
							<option value="dinner">Dinner</option>
							<option value="snack">Snack</option>
							<option value="other">Other</option>
						</select>
					</div>
				</div>

				<!-- Food Items Section -->
				<div class="food-items-section">
					<h3 class="section-header">
						<!-- Uses common style but icon is specific -->
						<span class="section-header-icon">🍎</span> Food Items
					</h3>
					<ul class="food-item-list" id="foodList">
						<!-- Example Item 1 -->
						<li class="food-item">
							<div class="food-item-info">
								<span class="food-item-name">Apple</span>
								<span class="food-item-details"
									>1 medium (approx. 95 kcal)</span
								>
							</div>
							<button
								class="remove-item-btn"
								onclick="removeItem(this)"
								title="Remove Item"
							>
								×
							</button>
						</li>
						<!-- Example Item 2 -->
						<li class="food-item">
							<div class="food-item-info">
								<span class="food-item-name"
									>Grilled Chicken Salad</span
								>
								<span class="food-item-details"
									>1 serving, olive oil dressing (approx. 350
									kcal)</span
								>
							</div>
							<button
								class="remove-item-btn"
								onclick="removeItem(this)"
								title="Remove Item"
							>
								×
							</button>
						</li>
						<!-- Example Item 3 -->
						<li class="food-item">
							<div class="food-item-info">
								<span class="food-item-name">Greek Yogurt</span>
								<span class="food-item-details"
									>1 cup (approx. 130 kcal)</span
								>
							</div>
							<button
								class="remove-item-btn"
								onclick="removeItem(this)"
								title="Remove Item"
							>
								×
							</button>
						</li>
					</ul>
					<button class="add-item-button" onclick="addFoodItem()">
						+ Add Food Item / Search Database
					</button>
				</div>

				<!-- Summary Section -->
				<div class="summary-section">
					<h3 class="section-header">
						<!-- Uses common style but icon is specific -->
						<span class="section-header-icon">📊</span> Meal Summary
						(Estimated)
					</h3>
					<div class="summary-grid" id="summaryGrid">
						<div class="summary-item">
							<div
								class="summary-item-value"
								data-summary="calories"
							>
								575
							</div>
							<div class="summary-item-label">Calories</div>
						</div>
						<div class="summary-item">
							<div
								class="summary-item-value"
								data-summary="protein"
							>
								45g
							</div>
							<div class="summary-item-label">Protein</div>
						</div>
						<div class="summary-item">
							<div
								class="summary-item-value"
								data-summary="carbs"
							>
								55g
							</div>
							<div class="summary-item-label">Carbs</div>
						</div>
						<div class="summary-item">
							<div class="summary-item-value" data-summary="fat">
								20g
							</div>
							<div class="summary-item-label">Fat</div>
						</div>
					</div>
				</div>
			</div>
			<!-- End Main Content -->

			<!-- Bottom Navigation Bar -->
			<nav class="bottom-nav" id="bottomNav">
				<a href="todo.shtml" class="nav-item" data-page="home">
					<span class="nav-icon">🏠</span>
					<span class="nav-label">Home</span>
				</a>
				<a href="progress.shtml" class="nav-item" data-page="progress">
					<span class="nav-icon">📊</span>
					<span class="nav-label">Progress</span>
				</a>
				<a
					href="log-meal.shtml"
					class="nav-item active"
					data-page="log-meal"
				>
					<span class="nav-icon">🍔</span>
					<span class="nav-label">Log Meal</span>
				</a>
				<a
					href="log-exercise.shtml"
					class="nav-item"
					data-page="log-exercise"
				>
					<span class="nav-icon">🏃</span>
					<span class="nav-label">Log Exercise</span>
				</a>
				<a href="profile.shtml" class="nav-item" data-page="profile">
					<span class="nav-icon">👤</span>
					<span class="nav-label">Profile</span>
				</a>
			</nav>
		</div>
		<!-- End ipad Container -->

		<script>
			// --- Apply theme early ---
			const htmlElement = document.documentElement;
			const savedTheme = localStorage.getItem("theme") || "light";
			if (savedTheme === "dark") {
				htmlElement.classList.add("dark-mode");
			} else {
				htmlElement.classList.remove("dark-mode");
			}
			// --- End Apply theme early ---

			const mockFoodDb = {
				/* ... same mock DB ... */
			};

			function saveMeal() {
				const foodItems = document.querySelectorAll(
					"#foodList .food-item"
				);
				if (foodItems.length === 0) {
					alert("Please add at least one food item before saving.");
					return;
				}
				alert("Meal Saved! (Implementation Needed)");
			}
			function addFoodItem() {
				/* ... same code ... */
			}
			function removeItem(button) {
				/* ... same code ... */
			}
			function updateSummary() {
				/* ... same code ... */
			}

			document.addEventListener("DOMContentLoaded", () => {
				const dateInput = document.getElementById("meal-date");
				const timeInput = document.getElementById("meal-time");
				if (!dateInput.value) {
					/* ... same date fallback ... */
				}
				if (!timeInput.value) {
					/* ... same time fallback ... */
				}
				updateSummary(); // Initial summary calculation

				// Active state for bottom nav
				const bottomNavContainer = document.getElementById("bottomNav");
				if (bottomNavContainer) {
					const navItems =
						bottomNavContainer.querySelectorAll(".nav-item");
					const currentPage =
						window.location.pathname.split("/").pop() ||
						"log-meal.shtml";
					navItems.forEach((item) => {
						const itemPage = item
							.getAttribute("href")
							?.split("/")
							.pop();
						item.classList.toggle(
							"active",
							itemPage === currentPage
						);
					});
				}
			});
		</script>
	</body>
</html>
